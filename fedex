const axios = require('axios');

async function getFedExTrackingInfo(trackingNumber) {
  // FedEx API credentials
  const clientId = 'YOUR_CLIENT_ID';
  const clientSecret = 'YOUR_CLIENT_SECRET';

  // FedEx API endpoints
  const authUrl = 'https://apis-sandbox.fedex.com/oauth/token';
  const trackingUrl = 'https://apis-sandbox.fedex.com/track/v1/trackingnumbers';

  try {
    // Step 1: Authenticate and get access token
    const authResponse = await axios.post(authUrl, 
      'grant_type=client_credentials&client_id=' + clientId + '&client_secret=' + clientSecret,
      {
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        }
      }
    );

    const accessToken = authResponse.data.access_token;

    // Step 2: Make the tracking request
    const trackingResponse = await axios.post(trackingUrl,
      {
        includeDetailedScans: true,
        trackingInfo: [
          {
            trackingNumberInfo: {
              trackingNumber: trackingNumber
            }
          }
        ]
      },
      {
        headers: {
          'Authorization': `Bearer ${accessToken}`,
          'Content-Type': 'application/json'
        }
      }
    );

    // Return the tracking data
    return trackingResponse.data;

  } catch (error) {
    console.error('Error fetching tracking info:', error.response ? error.response.data : error.message);
    throw error;
  }
}
l711f3710c5d974114a563fdc7592767b5
