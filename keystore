#!/bin/bash

# Set variables
PEM_CERT="your_certificate.pem"
PEM_KEY="your_private_key.pem"
KEYSTORE="kafka.keystore.jks"
KEYSTORE_PASSWORD="your_keystore_password"
KEY_PASSWORD="your_key_password"
ALIAS="kafka"

# Combine certificate and key into a PKCS12 file
openssl pkcs12 -export -in $PEM_CERT -inkey $PEM_KEY -name $ALIAS -out keystore.p12 -password pass:$KEYSTORE_PASSWORD

# Convert PKCS12 to JKS
keytool -importkeystore -srckeystore keystore.p12 -srcstoretype PKCS12 -srcstorepass $KEYSTORE_PASSWORD \
        -destkeystore $KEYSTORE -deststoretype JKS -deststorepass $KEYSTORE_PASSWORD \
        -alias $ALIAS -destkeypass $KEY_PASSWORD

# Clean up
rm keystore.p12

echo "Keystore created successfully: $KEYSTORE"
